@using Radzen
@using QLCongViec.Models
@inject DialogService DialogService

<RadzenCard Style="padding:20px;max-height:80vh;overflow:auto">

    <h4 style="font-weight:600;margin-bottom:16px">
        Chi tiết đề xuất
    </h4>

    @Field("Trạng thái", TrangThaiBadge(Model.TrangThai))
    @Field("Số quyết định", @<span>@Model.SoQuyetDinh</span>)
    @Field("Tên tài liệu", @<span>@Model.TenTaiLieu</span>)
    @Field("Loại hình biên soạn", @<span>@Model.LoaiHinh</span>)
    @Field("Chủ biên", @<span>@Model.ChuBien</span>)
    @Field("Môn học áp dụng", @<span>@Model.MonHoc</span>)
    @Field("Trình độ", @<span>@Model.TrinhDo</span>)
    @Field("Đơn vị đề xuất", @<span>@Model.DonVi</span>)

    <RadzenButton Text="Đóng"
                  Style="width:100%;margin-top:20px"
                  ButtonStyle="ButtonStyle.Dark"
                  Click="@(() => DialogService.Close())" />
</RadzenCard>

@code {
    [Parameter] public DeXuatModel Model { get; set; } = default!;

    RenderFragment Field(string label, RenderFragment content) => builder =>
    {
        builder.OpenElement(0, "div");
        builder.AddAttribute(1, "style", "margin-bottom:12px");

        builder.OpenElement(2, "div");
        builder.AddAttribute(3, "style", "color:#6c757d;font-size:13px");
        builder.AddContent(4, label);
        builder.CloseElement();

        builder.OpenElement(5, "div");
        builder.AddContent(6, content);
        builder.CloseElement();

        builder.CloseElement();
    };

    RenderFragment TrangThaiBadge(TrangThaiDeXuat t) => builder =>
    {
        var (text, color) = t switch
        {
            TrangThaiDeXuat.DaPheDuyet => ("Được phê duyệt", "#d1f7dc"),
            TrangThaiDeXuat.ChoXetDuyet => ("Chờ xét duyệt", "#fff3cd"),
            _ => ("Không phê duyệt", "#f8d7da")
        };

        builder.OpenElement(0, "span");
        builder.AddAttribute(1, "style",
            $"padding:6px 12px;border-radius:16px;background:{color}");
        builder.AddContent(2, text);
        builder.CloseElement();
    };
}
