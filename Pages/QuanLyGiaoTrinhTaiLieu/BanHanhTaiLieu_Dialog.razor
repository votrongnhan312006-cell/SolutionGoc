@using api.Models.QLBienSoan
@inject ApiServices apiService
@inject DialogService DialogService
@inherits OwningComponentBase


<RadzenTemplateForm Data="@model" TItem="tbGTTL" Submit="@HandleSubmit">
    <RadzenCard>
        <RadzenText TextStyle="TextStyle.H5">Nháº­p thÃ´ng tin ban hÃ nh</RadzenText>
        <p class="text-muted">@selectedItem?.TenGTTL</p>

        <hr />

        <!-- DÃ²ng 1: Sá»‘ quyáº¿t Ä‘á»‹nh vÃ  NgÃ y kÃ½ -->
        <div class="row" style="margin-bottom: 16px;">
            <div class="col-md-6">
                <RadzenLabel Text="Sá»‘ quyáº¿t Ä‘á»‹nh *" Component="SoQD" Style="margin-bottom: 8px; display: block;" />
                <RadzenTextBox @bind-Value="model.SqdBanHanh" Placeholder="VÃ­ dá»¥: 789/QÄ-HV" Style="width:100%" />
            </div>
            <div class="col-md-6">
                <RadzenLabel Text="NgÃ y kÃ½ *" Component="NgayKy" Style="margin-bottom: 8px; display: block;" />
                <RadzenDatePicker @bind-Value="model.NgayBanHanh" DateFormat="dd/MM/yyyy" Style="width:100%" />
            </div>
        </div>

        <!-- DÃ²ng 2: ÄÆ¡n vá»‹ ban hÃ nh -->
        <div class="row" style="margin-bottom: 16px;">
            <div class="col-md-12">
                <RadzenLabel Text="ÄÆ¡n vá»‹ ban hÃ nh" Component="DonVi" Style="margin-bottom: 8px; display: block;" />
                <RadzenTextBox Placeholder="Há»c viá»‡n" Style="width:100%" ReadOnly = "true"/>
            </div>
        </div>

        <!-- DÃ²ng 3: NgÆ°á»i kÃ½ -->
        <div class="row" style="margin-bottom: 16px;">
            <div class="col-md-12">
                <RadzenLabel Text="NgÆ°á»i kÃ½" Component="NguoiKy" Style="margin-bottom: 8px; display: block;" />
                <RadzenTextBox @bind-Value="model.GhiChu" Placeholder="VÃ­ dá»¥: GiÃ¡m Ä‘á»‘c Nguyá»…n VÄƒn A" Style="width:100%" />
            </div>
        </div>

        <!-- DÃ²ng 4: ThÃ´ng tin xuáº¥t báº£n -->
        <div class="row" style="margin-bottom: 16px;">
            <div class="col-md-6">
                <RadzenLabel Text="Sá»‘ lÆ°á»£ng xuáº¥t báº£n" Component="SoLuong" Style="margin-bottom: 8px; display: block;" />
                <RadzenNumeric @bind-Value="model.SoBanIn" Placeholder="VÃ­ dá»¥: 500" Style="width:100%" />
            </div>
            <div class="col-md-6">
                <RadzenLabel Text="ÄÆ¡n vá»‹ in áº¥n" Component="DonViIn" Style="margin-bottom: 8px; display: block;" />
                <RadzenTextBox @bind-Value="model.FileDangKy" Placeholder="TÃªn Ä‘Æ¡n vá»‹ in áº¥n" Style="width:100%" />
            </div>
        </div>

        <!-- DÃ²ng 5: NgÃ y dá»± kiáº¿n cÃ³ sÃ¡ch -->
        <div class="row" style="margin-bottom: 16px;">
            <div class="col-md-12">
                <RadzenLabel Text="NgÃ y dá»± kiáº¿n cÃ³ sÃ¡ch" Component="NgayDuKien" Style="margin-bottom: 8px; display: block;" />
                <RadzenDatePicker @bind-Value="model.HanHoanThanh" DateFormat="dd/MM/yyyy" Style="width:100%" />
            </div>
        </div>

        <!-- DÃ²ng 6: File quyáº¿t Ä‘á»‹nh ban hÃ nh -->
        <div class="row" style="margin-bottom: 16px;">
            <div class="col-md-12">
                <RadzenLabel Text="File quyáº¿t Ä‘á»‹nh ban hÃ nh *" Component="FileQD" Style="margin-bottom: 8px; display: block;" />
                <div style="border: 2px dashed #ccc; border-radius: 8px; padding: 40px; text-align: center; background-color: #fafafa;">
                    <div style="font-size: 48px; margin-bottom: 12px;">ðŸ“¤</div>
                    <div style="color: #666; margin-bottom: 8px;">Táº£i lÃªn quyáº¿t Ä‘á»‹nh ban hÃ nh</div>
                    <div style="color: #999; font-size: 12px;">PDF, DOC, DOCX (tá»‘i Ä‘a 10MB)</div>
                </div>
            </div>
        </div>

        <!-- NÃºt lÆ°u -->
        <div class="mt-3" style="margin-top: 24px;">
            <RadzenButton Text="LÆ°u" Icon="save" ButtonStyle="ButtonStyle.Primary" Type="Submit" Style="width:100%" />
        </div>
    </RadzenCard>
</RadzenTemplateForm>

@code {
    [Parameter] public tbGTTL selectedItem { get; set; }
    private tbGTTL model = new();

    protected override async Task OnInitializedAsync()
    {
         model = selectedItem; // Gáº¯n dá»¯ liá»‡u tá»« trang cha
    }

    async Task HandleSubmit()
    {
        await apiService.Update<tbGTTL>(model);
        DialogService.Close(true);
    }
}
